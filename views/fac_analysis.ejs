<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" initial-scale=1>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
</head>
<style type="text/css">
    body, html {
    height: 100%;
    font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana,sans-serif;
}
img{
    height:  100px;
    width: 150px;
   /* border: 2px blue dotted;*/
}
a{
    color: white;
    text-decoration: none;
}
a:hover{
    color: white;
    text-decoration: none;
}
</style>
<body>
    <div class="container mt-3">
        <div class="container" style="width: 1100px;height: 400px;">
                <ul class="nav nav-tabs nav-justified">
                            <li class="nav-item">
                                <a class="nav-link mb-3 primary" data-bs-toggle = "tab" href="#faculty" style="font-size: 40px;"><b>Faculty</b></a>
                            </li>
                </ul>
                <div class="tab-content">
                            <div class="tab-pane container active mt-3" id = "faculty">
                                <center>
                                <form action="/fac_dateSubmit" method="GET">
                                <label>Select Date Month and Year:</label>
                                <input min="01" max="31" placeholder="DD" type="number" id="date" name="date" >
                                <select id="mon" name="mon">
                                    <option value="" disabled selected>MM</option>
                                    <option value="01">January</option>
                                    <option value="02">February</option>
                                    <option value="03">March</option>
                                    <option value="04">April</option>
                                    <option value="05">May</option>
                                    <option value="06">June</option>
                                    <option value="07">July</option>
                                    <option value="08">August</option>
                                    <option value="09">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                                <input type="number" placeholder="YYYY" min="1999" max="2025" id="year" name="year">&nbsp;&nbsp;<input type="submit" class="btn btn-primary btn-sm" value="Submit">
                                <br>
                            </form>
                                <form action="/facidSubmit" method="GET">
                                <label>Enter Faculty ID: </label> <input type="text" name="facid" size="19">
                                &nbsp;<input type="submit" class="btn btn-primary btn-sm" value="Submit">
                                <br>
                            </form>
                                <form action="/fac_eventSubmit" method="GET">
                                <label>Select Type of Event: </label>       <select id="event" name="event" style="width:217px">
                                    <option value="FDP">FDP</option>
                                    <option value="Short Term Course">Short Term Course</option>
                                    <option value="Webinar">Webinar</option>
                                    <option value="Online course">Online course</option>
                                    <option value="Paper Presentation">Paper Presentation</option>
                                    <option value="Bootcamp">Bootcamp</option>
                                    <option value="Workshop">Workshop</option>
                                    <option value="Conference">Conference</option>
                                </select>
                                &nbsp;<input type="submit" class="btn btn-primary btn-sm" value="Submit">
                                <br>
                               </form><br>
                                <h3>Here are the achievements of all faculties!!!</h3>
                            </center>
                                <div class="container mt-3">
                                    <table  class="table table-striped" style="border:1px solid black">
                                        <thead align="center" >
                                            <th>Sno:</th>
                                            <th>Faculty ID</th>
                                        <th>Certificate Details</th>
                                        <th>Description</th>
                                        <th>Certificate</th>
                                    </thead>
                                    <tbody id ="tbody2" align="center"></tbody>
                                    </table>
                                </div>
            </div>
        </div>
    </div>
    </div>
    <script type="module">
                import { initializeApp } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js";
                const firebaseConfig = {
                apiKey: "AIzaSyBhxPZMVpzSuE3sxrqLGhtd6fuJSLtkv04",
                authDomain: "certifyu-3c613.firebaseapp.com",
                projectId: "certifyu-3c613",
                storageBucket: "certifyu-3c613.appspot.com",
                messagingSenderId: "953870110932",
                appId: "1:953870110932:web:cbd814e977ac1ee775ab41",
                };
                const app = initializeApp(firebaseConfig);
   
                import{getStorage,ref as sRef,uploadBytesResumable,getDownloadURL} from "https://www.gstatic.com/firebasejs/9.13.0/firebase-storage.js"
                import{getFirestore,doc,getDoc,setDoc,collection,addDoc} from "https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js";
                import{getDocs,onSnapshot} from "https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js";

                const clouddb = getFirestore();
                 var sno1 = 0;
                 var tbody2 = document.getElementById("tbody2");
                 function AddItemToTable1(cname1,curl1,cid1,start,end,event,inst,des,facid){
                 let trow = document.createElement("tr");
                 let td1 = document.createElement("td");
                 let td2 = document.createElement("td");
                 let td3 = document.createElement("td");
                 let td4 = document.createElement("td");
                 let td5 = document.createElement("td");
                 var image = document.createElement("img");
                 image.height = 50;
                 image.width = 50;

                 image.src = curl1;
                    td1.innerHTML = ++sno1;
                    td2.innerHTML = facid;
                    td3.innerHTML = "<b>Certificate Name:</b>"+cname1 +"<br><b>Certificate ID:</b>" +cid1+"<br><b>Start Date:</b>"+start+"<br><b>End Date:</b>"+end+"<br><b>Institution:</b>"+inst+"<br><b>Event:</b>"+event;
                    td4.innerHTML=des;
                    td5.appendChild(image);
                var btn = document.createElement("BUTTON");
                var link = document.createElement("A");
                
                btn.setAttribute("class",'btn btn-primary btn-sm');
                var text = document.createTextNode("View");
               link.setAttribute("href",curl1);
               
               var break1 = document.createElement("br");
               var break2 = document.createElement("br");
                link.appendChild(text);
                btn.appendChild(link);
                btn.style.display = "block";
                btn.style.margin = "0 auto";
                td5.appendChild(break1);
                td5.appendChild(break2);
                td5.appendChild(btn);
                    trow.appendChild(td1);
                    trow.appendChild(td2);
                    trow.appendChild(td3);
                    trow.appendChild(td4);
                    trow.appendChild(td5);
                    tbody2.appendChild(trow);

                 } 
                 // sno = 0;
                 function AddAllItemsToTable1(TheStudent,facid){
                    
                    // tbody.innerHTML = "";
                    TheStudent.forEach(element =>{

                        AddItemToTable1(element.Certificate_Name,element.ImageURL,element.Certificate_ID,element.Start_Date,element.End_Date,element.Event,element.Institution,element.Description,facid);
                    });

                 }
               

                 //get all data 
                 async function GetAllDataOnce1(){

                    const x = await getDocs(collection(clouddb,'Faculty/'));
                    var facids = [];
                    x.forEach(doc => {
                        facids.push(doc.data().faculty_id);
                    });
                    facids.forEach(async facid1 =>{
                        const querySnapshot = await getDocs(collection(clouddb,'Faculty/'+facid1+'/certificates/'));
                        var students = [];
                        querySnapshot.forEach(doc =>{
                        students.push(doc.data());
                        });
                        AddAllItemsToTable1(students,facid1);
                    });
                 }
                 window.onload = GetAllDataOnce1;
    </script>
</body>
</html>